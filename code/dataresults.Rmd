---
title: "dataprep"
author: "Jack"
date: "2023-02-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
canopydifftri <- read_excel("~/Documents/R/hons_local_r/canopydifftri.xlsx", 
                            col_types = c("text", "numeric", "numeric"))
```
```{r}
View(canopydifftri2)
```

```{r}
summarise(canopydifftri2, Mean.TRI = mean(TRI))
```
```{r}
summarise(canopydifftri2,
  mean.activity = mean(TRI), # mean
  min.Activity = min(TRI), # minimum
  max.Activity = max(TRI), # maximum
  med.Activity = median(TRI), # median
  sd.Activity = sd(TRI), # standard deviation
  var.Activity = var(TRI), # variance
) # interquartile range
```
```{r}
#remove na values
summarise(canopydifftri2, mean.TRI = mean(TRI, na.rm = TRUE))
```
```{r}
summarise(canopydifftri2, mean.canopydiff = mean(canopydiff, na.rm = TRUE))
```

#sample size with na removed 
```{r}
length(canopydifftri2$TRI[!is.na(canopydifftri2$TRI)])
```
#396430 now, so 3570 na values in TRI data

```{r}
length(canopydifftri2$canopydiff[!is.na(canopydifftri2$canopydiff)])
```

#392584 now , so 7416 na values in canopy difference



```{r}
 is.na(canopydifftri2)
```


#test plot
```{r}
plot(canopydiff ~ TRI, data = canopydifftri2)
```
#i.e can see some clear outliers eg.1200 tri and 1000m canopy difference which is not really posible 

#so need to clean this data
```{r}
glimpse(canopydifftri2)
```

```{r}
#ID data type needs changing 
class(canopydifftri2$ID)
unique(canopydifftri2$ID)

```

```{r}
#change ID data type to be a factor
canopydifftri2$ID <- as.factor(canopydifftri2$ID)
```
```{r}
class(canopydifftri2$ID)
```
#now a factor 
```{r}
levels(canopydifftri2$ID)
```

#i.e no order in sites as factor 

#missing data- will exclude na values as na don't mean anything for this data as tri or height difference can't be na it would be 0 or -0.1 etc.
```{r}
canopy_nar <- na.omit(canopydifftri2)

```
# so now 389,014 data points from 400,000 so only 10986 na values

```{r}
#getting real results now
mean(canopy_nar$TRI)
```

#now outliers need removing 
```{r}
boxplot(canopy_nar$TRI)
```
```{r}
summary(canopy_nar$TRI)
```
#i.e huge max value of 1327.4140 TRI

```{r}
boxplot.stats(canopy_nar$TRI)$out
```
```{r}
canopy_nar %>%
  ggplot(aes(x=canopydiff, y=TRI)) +
  geom_point()

```
#i.e  key outliers in difference and tri 

```{r}
boxplot(canopy_nar$canopydiff)
```
#again same for difference in canopy 
